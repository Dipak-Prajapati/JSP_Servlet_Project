package com.dips.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.dips.pojo.RegisterPojo;
import com.dips.singleton.DbConnection;

public class DaoRegisterImpl implements DaoRegister{

	Connection con;
	//ResultSet result;
	PreparedStatement preparedStatement;
	DbConnection dbInstance;
	
	public DaoRegisterImpl()
	{
		System.out.println("Hello Constructor from Dao");
		dbInstance = DbConnection.getInstance("jdbc:mysql://localhost:","3306","root","password");
	}
	
	@Override
	public void connect() {
		// TODO Auto-generated method stub
		try {
			con=dbInstance.Connect("jspservlet");
			System.out.println("Database name passed");
		} catch (ClassNotFoundException | SQLException e) {
			System.out.println("\n Failed To Connnect DB " + e );
		}
	}

	@Override
	public boolean addUser(RegisterPojo registerPojo) {
		// TODO Auto-generated method stub
		boolean result;
		System.out.println(registerPojo);
		System.out.println("In DaoRegister Class addUser");
		
		try
		{
			preparedStatement = con.prepareStatement("insert into user(firstname,middlename,lastname,email,dob,mobile_no,gender,language,hobbie,password) values(?,?,?,?,?,?,?,?,?,?)");
			preparedStatement.setString(1, registerPojo.getFirstName());
			preparedStatement.setString(2, registerPojo.getMiddleName());
			preparedStatement.setString(3, registerPojo.getLastName());
			preparedStatement.setString(4, registerPojo.getEmail());
			preparedStatement.setString(5, registerPojo.getDob());
			preparedStatement.setString(6, registerPojo.getMobile_no());
			preparedStatement.setString(7, registerPojo.getGender());
			preparedStatement.setString(8, registerPojo.getLanguage());
			preparedStatement.setString(9, registerPojo.getHiobbie());
			preparedStatement.setString(10, registerPojo.getPassword());
			//preparedStatement.setString(5, registerPojo.getImage());
			//preparedStatement.setBlob(11, registerPojo.getImage());
			
			System.out.println(registerPojo.getDob());
			
			//preparedStatement.setString(10, "user");
			result = preparedStatement.executeUpdate() > 0;
			//int id=getKey();
			//registerPojo.setRegisterId(id);
		}
		catch(SQLException e)
		{
			System.out.println(e);
		}
		return result;
	}

}
